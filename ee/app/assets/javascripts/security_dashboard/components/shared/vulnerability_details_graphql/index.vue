<script>
import { GlLink } from '@gitlab/ui';
import { s__ } from '~/locale';
import { SEVERITY_LEVELS_GRAPHQL } from 'ee/security_dashboard/store/constants';
import SeverityBadge from 'ee/vue_shared/security_reports/components/severity_badge.vue';
import DetailsSection from './details_section.vue';
import DetailsSectionListItem from './details_section_list_item.vue';

export default {
  i18n: {
    descriptionSectionHeading: s__('Vulnerability|Description'),
    severityLabel: s__('Vulnerability|Severity:'),
    projectLabel: s__('Vulnerability|Project:'),
  },
  components: {
    GlLink,
    SeverityBadge,
    DetailsSection,
    DetailsSectionListItem,
  },
  props: {
    /**
     * Description of the vulnerability finding.
     *
     * @type string
     * */
    description: {
      type: String,
      required: true,
    },
    /**
     * Severity of the vulnerability finding.
     *
     * Possible values: 'INFO', 'UNKNOWN', 'LOW', 'MEDIUM', 'HIGH', 'CRITICAL'
     *
     * @typedef {('INFO'|'UNKNOWN'|'LOW'|'MEDIUM'|'HIGH'|'CRITICAL')} Severity
     * @type Severity
     */
    severity: {
      type: String,
      required: true,
      validator: (v) => SEVERITY_LEVELS_GRAPHQL.includes(v),
    },
    /**
     * Project on which the vulnerability finding was found.
     *
     * @typedef {{ name: string, webUrl: string }} Project
     * @type Project
     */
    project: {
      type: Object,
      required: true,
    },
  },
};
</script>

<template>
  <article>
    <details-section
      :heading="$options.i18n.descriptionSectionHeading"
      data-testid="description-section"
    >
      <p>{{ description }}</p>
    </details-section>

    <details-section>
      <template #list>
        <details-section-list-item
          :label="$options.i18n.severityLabel"
          data-testid="severity-list-item"
        >
          <severity-badge class="gl-display-inline-block gl-ml-2" :severity="severity" />
        </details-section-list-item>
        <details-section-list-item
          :label="$options.i18n.projectLabel"
          data-testid="project-list-item"
        >
          <gl-link :href="project.webUrl">{{ project.name }}</gl-link>
        </details-section-list-item>
      </template>
    </details-section>
  </article>
</template>
